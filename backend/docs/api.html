<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dream API æµ‹è¯•å·¥å…·</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    h1 { text-align: center; margin-bottom: 20px; color: #333; }
    .auth-section { background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .auth-section h3 { margin-bottom: 15px; color: #666; }
    .auth-section input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px; }
    .tabs { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
    .tab { padding: 10px 20px; background: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
    .tab.active { background: #4f46e5; color: #fff; }
    .api-group { background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .api-group h3 { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
    .api-item { padding: 15px; border: 1px solid #eee; border-radius: 4px; margin-bottom: 10px; }
    .api-item:hover { border-color: #4f46e5; }
    .api-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
    .method { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; color: #fff; }
    .method.GET { background: #10b981; }
    .method.POST { background: #3b82f6; }
    .method.PUT { background: #f59e0b; }
    .method.DELETE { background: #ef4444; }
    .path { font-family: monospace; color: #333; }
    .desc { color: #666; font-size: 14px; }
    .params { margin-top: 10px; }
    .params textarea { width: 100%; height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 13px; }
    .params input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; margin-top: 5px; }
    .btn { padding: 8px 16px; background: #4f46e5; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
    .btn:hover { background: #4338ca; }
    .btn:disabled { background: #ccc; cursor: not-allowed; }
    .response { margin-top: 10px; padding: 10px; background: #1e1e1e; border-radius: 4px; color: #d4d4d4; font-family: monospace; font-size: 13px; white-space: pre-wrap; max-height: 300px; overflow: auto; display: none; }
    .response.show { display: block; }
    .response.error { background: #fee2e2; color: #991b1b; }
    .response.success { background: #d1fae5; color: #065f46; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ Dream API æµ‹è¯•å·¥å…·</h1>
    
    <div class="auth-section">
      <h3>ğŸ”‘ è®¤è¯é…ç½®</h3>
      <input type="text" id="baseUrl" value="http://localhost:3000" placeholder="API Base URL">
      <input type="text" id="jwtToken" placeholder="JWT Token (ç™»å½•åè‡ªåŠ¨å¡«å……)">
      <input type="text" id="adminKey" value="admin_secret_key_change_in_production" placeholder="Admin API Key">
    </div>

    <div class="tabs">
      <button class="tab active" data-group="auth">è®¤è¯</button>
      <button class="tab" data-group="user">ç”¨æˆ·</button>
      <button class="tab" data-group="jobs">ç”Ÿæˆä»»åŠ¡</button>
      <button class="tab" data-group="proxy">ä»£ç†æ¥å£</button>
      <button class="tab" data-group="templates">æ¨¡æ¿</button>
      <button class="tab" data-group="characters">è§’è‰²</button>
      <button class="tab" data-group="admin">ç®¡ç†</button>
    </div>

    <!-- è®¤è¯æ¨¡å— -->
    <div class="api-group" data-group="auth">
      <h3>ğŸ” è®¤è¯æ¨¡å—</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/auth/send-code</span>
        </div>
        <div class="desc">å‘é€çŸ­ä¿¡éªŒè¯ç </div>
        <div class="params">
          <textarea id="send-code-body">{"phone": "13800138000"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/auth/send-code', 'send-code-body', 'send-code-resp', false)">å‘é€</button>
        </div>
        <div class="response" id="send-code-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/auth/phone-login</span>
        </div>
        <div class="desc">æ‰‹æœºå·ç™»å½•/æ³¨å†Œï¼ˆè‡ªåŠ¨æ³¨å†Œæ–°ç”¨æˆ·ï¼‰</div>
        <div class="params">
          <textarea id="phone-login-body">{"phone": "13800138000", "code": "123456"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/auth/phone-login', 'phone-login-body', 'phone-login-resp', false, true)">ç™»å½•</button>
        </div>
        <div class="response" id="phone-login-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/auth/wechat-login</span>
        </div>
        <div class="desc">å¾®ä¿¡ç™»å½•</div>
        <div class="params">
          <textarea id="wechat-login-body">{"code": "wx_login_code", "phoneCode": "phone_code_optional", "userInfo": {"nickName": "æµ‹è¯•ç”¨æˆ·"}}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/auth/wechat-login', 'wechat-login-body', 'wechat-login-resp', false, true)">ç™»å½•</button>
        </div>
        <div class="response" id="wechat-login-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/auth/bind-phone</span>
        </div>
        <div class="desc">ç»‘å®šæ‰‹æœºå·åˆ°å½“å‰è´¦å·</div>
        <div class="params">
          <textarea id="bind-phone-body">{"phone": "13800138000", "code": "123456"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/auth/bind-phone', 'bind-phone-body', 'bind-phone-resp', true)">ç»‘å®š</button>
        </div>
        <div class="response" id="bind-phone-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/auth/userinfo</span>
        </div>
        <div class="desc">è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯å’Œç»Ÿè®¡</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/auth/userinfo', null, 'userinfo-resp', true)">è·å–</button>
        </div>
        <div class="response" id="userinfo-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/auth/check</span>
        </div>
        <div class="desc">æ£€æŸ¥ç™»å½•çŠ¶æ€</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/auth/check', null, 'auth-check-resp', true)">æ£€æŸ¥</button>
        </div>
        <div class="response" id="auth-check-resp"></div>
      </div>
    </div>

    <!-- ç”¨æˆ·æ¨¡å— -->
    <div class="api-group hidden" data-group="user">
      <h3>ğŸ‘¤ ç”¨æˆ·æ¨¡å—</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/users/me</span>
        </div>
        <div class="desc">è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/users/me', null, 'users-me-resp', true)">è·å–</button>
        </div>
        <div class="response" id="users-me-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/users/me/stats</span>
        </div>
        <div class="desc">è·å–ç”¨æˆ·ç»Ÿè®¡ï¼ˆæ”¶è—ã€ç”Ÿæˆæ•°ã€é…é¢ç­‰ï¼‰</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/users/me/stats', null, 'users-stats-resp', true)">è·å–</button>
        </div>
        <div class="response" id="users-stats-resp"></div>
      </div>
    </div>

    <!-- ç”Ÿæˆä»»åŠ¡æ¨¡å— -->
    <div class="api-group hidden" data-group="jobs">
      <h3>ğŸ¨ ç”Ÿæˆä»»åŠ¡æ¨¡å—ï¼ˆæœ¬åœ°è®°å½•ï¼‰</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/jobs/quota</span>
        </div>
        <div class="desc">è·å–é…é¢ä¿¡æ¯</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/jobs/quota', null, 'jobs-quota-resp', true)">è·å–</button>
        </div>
        <div class="response" id="jobs-quota-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/jobs</span>
        </div>
        <div class="desc">åˆ›å»ºç”Ÿæˆä»»åŠ¡ï¼ˆè‡ªåŠ¨æ£€æŸ¥é…é¢ï¼‰</div>
        <div class="params">
          <textarea id="create-job-body">{"prompt": "A cute cat", "aspectRatio": "1:1"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/jobs', 'create-job-body', 'create-job-resp', true)">åˆ›å»º</button>
        </div>
        <div class="response" id="create-job-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/jobs</span>
        </div>
        <div class="desc">è·å–æœ¬åœ°ä»»åŠ¡åˆ—è¡¨</div>
        <div class="params">
          <input type="text" id="jobs-list-params" value="page=1&limit=10" placeholder="æŸ¥è¯¢å‚æ•°">
          <button class="btn" onclick="callApiWithQuery('GET', '/v1/jobs', 'jobs-list-params', 'jobs-list-resp', true)">è·å–</button>
        </div>
        <div class="response" id="jobs-list-resp"></div>
      </div>
    </div>

    <!-- ä»£ç†æ¨¡å— -->
    <div class="api-group hidden" data-group="proxy">
      <h3>ğŸ”„ ä»£ç†æ¨¡å—ï¼ˆç¬¬ä¸‰æ–¹ AI æœåŠ¡ï¼‰</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/proxy/images/generate</span>
        </div>
        <div class="desc">ç”Ÿæˆå›¾ç‰‡ï¼ˆä»£ç†åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰</div>
        <div class="params">
          <textarea id="proxy-generate-body">{"prompt": "A beautiful sunset", "mode": "final"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/proxy/images/generate', 'proxy-generate-body', 'proxy-generate-resp', true)">ç”Ÿæˆ</button>
        </div>
        <div class="response" id="proxy-generate-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/proxy/jobs</span>
        </div>
        <div class="desc">è·å–ä»»åŠ¡åˆ—è¡¨ï¼ˆç¬¬ä¸‰æ–¹ï¼‰</div>
        <div class="params">
          <input type="text" id="proxy-jobs-params" value="limit=10" placeholder="æŸ¥è¯¢å‚æ•°">
          <button class="btn" onclick="callApiWithQuery('GET', '/v1/proxy/jobs', 'proxy-jobs-params', 'proxy-jobs-resp', true)">è·å–</button>
        </div>
        <div class="response" id="proxy-jobs-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/proxy/jobs/:jobId</span>
        </div>
        <div class="desc">è·å–ä»»åŠ¡è¯¦æƒ…</div>
        <div class="params">
          <input type="text" id="proxy-job-id" placeholder="Job ID">
          <button class="btn" onclick="callApiWithPath('GET', '/v1/proxy/jobs/', 'proxy-job-id', 'proxy-job-resp', true)">è·å–</button>
        </div>
        <div class="response" id="proxy-job-resp"></div>
      </div>
    </div>

    <!-- æ¨¡æ¿æ¨¡å— -->
    <div class="api-group hidden" data-group="templates">
      <h3>ğŸ“ æ¨¡æ¿æ¨¡å—</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/templates/prompts</span>
        </div>
        <div class="desc">è·å–æç¤ºè¯æ¨¡æ¿åˆ—è¡¨</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/templates/prompts', null, 'templates-prompts-resp', false)">è·å–</button>
        </div>
        <div class="response" id="templates-prompts-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/templates/params</span>
        </div>
        <div class="desc">è·å–å‚æ•°æ¨¡æ¿åˆ—è¡¨</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/templates/params', null, 'templates-params-resp', false)">è·å–</button>
        </div>
        <div class="response" id="templates-params-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/templates/prompts</span>
        </div>
        <div class="desc">åˆ›å»ºæç¤ºè¯æ¨¡æ¿ï¼ˆéœ€è¦ Admin Keyï¼‰</div>
        <div class="params">
          <textarea id="create-prompt-body">{"templateId": "test-001", "title": "æµ‹è¯•æ¨¡æ¿", "prompt": "A test prompt", "category": "test"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/templates/prompts', 'create-prompt-body', 'create-prompt-resp', false, false, true)">åˆ›å»º</button>
        </div>
        <div class="response" id="create-prompt-resp"></div>
      </div>
    </div>

    <!-- è§’è‰²æ¨¡å— -->
    <div class="api-group hidden" data-group="characters">
      <h3>ğŸ­ è§’è‰²æ¨¡å—</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/characters</span>
        </div>
        <div class="desc">è·å–æˆ‘çš„è§’è‰²åˆ—è¡¨</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/characters', null, 'characters-list-resp', true)">è·å–</button>
        </div>
        <div class="response" id="characters-list-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method POST">POST</span>
          <span class="path">/v1/characters</span>
        </div>
        <div class="desc">åˆ›å»ºè§’è‰²</div>
        <div class="params">
          <textarea id="create-character-body">{"name": "æµ‹è¯•è§’è‰²", "description": "è§’è‰²æè¿°"}</textarea>
          <button class="btn" onclick="callApi('POST', '/v1/characters', 'create-character-body', 'create-character-resp', true)">åˆ›å»º</button>
        </div>
        <div class="response" id="create-character-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method DELETE">DELETE</span>
          <span class="path">/v1/characters/:uuid</span>
        </div>
        <div class="desc">åˆ é™¤è§’è‰²</div>
        <div class="params">
          <input type="text" id="delete-character-uuid" placeholder="Character UUID">
          <button class="btn" onclick="callApiWithPath('DELETE', '/v1/characters/', 'delete-character-uuid', 'delete-character-resp', true)">åˆ é™¤</button>
        </div>
        <div class="response" id="delete-character-resp"></div>
      </div>
    </div>

    <!-- ç®¡ç†æ¨¡å— -->
    <div class="api-group hidden" data-group="admin">
      <h3>âš™ï¸ ç®¡ç†æ¨¡å—</h3>
      
      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/admin/stats</span>
        </div>
        <div class="desc">è·å–ç®¡ç†ç»Ÿè®¡</div>
        <div class="params">
          <button class="btn" onclick="callApi('GET', '/v1/admin/stats', null, 'admin-stats-resp', false, false, true)">è·å–</button>
        </div>
        <div class="response" id="admin-stats-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method GET">GET</span>
          <span class="path">/v1/admin/users</span>
        </div>
        <div class="desc">è·å–ç”¨æˆ·åˆ—è¡¨</div>
        <div class="params">
          <input type="text" id="admin-users-params" value="page=1&limit=10" placeholder="æŸ¥è¯¢å‚æ•°">
          <button class="btn" onclick="callApiWithQuery('GET', '/v1/admin/users', 'admin-users-params', 'admin-users-resp', false, true)">è·å–</button>
        </div>
        <div class="response" id="admin-users-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method PUT">PUT</span>
          <span class="path">/v1/admin/users/:id/vip</span>
        </div>
        <div class="desc">è®¾ç½®ç”¨æˆ· VIP</div>
        <div class="params">
          <input type="text" id="set-vip-user-id" placeholder="User ID">
          <textarea id="set-vip-body">{"vipLevel": "VIP", "days": 30}</textarea>
          <button class="btn" onclick="callApiWithPathAndBody('PUT', '/v1/admin/users/', '/vip', 'set-vip-user-id', 'set-vip-body', 'set-vip-resp', true)">è®¾ç½®</button>
        </div>
        <div class="response" id="set-vip-resp"></div>
      </div>

      <div class="api-item">
        <div class="api-header">
          <span class="method DELETE">DELETE</span>
          <span class="path">/v1/admin/users/:id/vip</span>
        </div>
        <div class="desc">å–æ¶ˆç”¨æˆ· VIP</div>
        <div class="params">
          <input type="text" id="cancel-vip-user-id" placeholder="User ID">
          <button class="btn" onclick="callApiWithPath('DELETE', '/v1/admin/users/', '/vip', 'cancel-vip-user-id', 'cancel-vip-resp', true)">å–æ¶ˆ</button>
        </div>
        <div class="response" id="cancel-vip-resp"></div>
      </div>
    </div>
  </div>

  <script>
    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        const group = tab.dataset.group;
        document.querySelectorAll('.api-group').forEach(g => {
          g.classList.toggle('hidden', g.dataset.group !== group);
        });
      });
    });

    function getBaseUrl() {
      return document.getElementById('baseUrl').value;
    }

    function getJwtToken() {
      return document.getElementById('jwtToken').value;
    }

    function getAdminKey() {
      return document.getElementById('adminKey').value;
    }

    async function callApi(method, path, bodyId, respId, needAuth, saveToken = false, needAdmin = false) {
      const respEl = document.getElementById(respId);
      respEl.classList.remove('success', 'error');
      respEl.classList.add('show');
      respEl.textContent = 'Loading...';

      const headers = { 'Content-Type': 'application/json' };
      if (needAuth) headers['Authorization'] = `Bearer ${getJwtToken()}`;
      if (needAdmin) headers['X-Admin-Key'] = getAdminKey();

      const options = { method, headers };
      if (bodyId) {
        const body = document.getElementById(bodyId).value;
        options.body = body;
      }

      try {
        const res = await fetch(`${getBaseUrl()}${path}`, options);
        const data = await res.json();
        
        respEl.classList.add(res.ok ? 'success' : 'error');
        respEl.textContent = JSON.stringify(data, null, 2);

        if (saveToken && data.token) {
          document.getElementById('jwtToken').value = data.token;
        }
      } catch (err) {
        respEl.classList.add('error');
        respEl.textContent = `Error: ${err.message}`;
      }
    }

    async function callApiWithQuery(method, path, paramsId, respId, needAuth, needAdmin = false) {
      const params = document.getElementById(paramsId).value;
      const fullPath = params ? `${path}?${params}` : path;
      await callApi(method, fullPath, null, respId, needAuth, false, needAdmin);
    }

    async function callApiWithPath(method, basePath, pathId, respId, needAuth, suffix = '') {
      const pathValue = document.getElementById(pathId).value;
      const fullPath = `${basePath}${pathValue}${suffix}`;
      await callApi(method, fullPath, null, respId, needAuth);
    }

    async function callApiWithPathAndBody(method, basePath, suffix, pathId, bodyId, respId, needAdmin) {
      const pathValue = document.getElementById(pathId).value;
      const fullPath = `${basePath}${pathValue}${suffix}`;
      await callApi(method, fullPath, bodyId, respId, false, false, needAdmin);
    }
  </script>
</body>
</html>
